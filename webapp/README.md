# 跨链VC系统Web前端

## 🎯 功能概述

这是一个完整的Web前端应用，用于监控和操作跨链VC系统，包括：

- **实时监控**: Besu链A/B状态、Oracle服务、ACA-Py服务
- **智能合约监控**: 合约部署状态、变量值、授权情况
- **跨链转账**: 交互式跨链转账操作
- **VC状态**: 凭证注册、定义、颁发状态
- **实时日志**: 系统运行日志和操作记录

## 🚀 快速开始

### 1. 环境要求

- Python 3.7+
- pip3
- 已运行的Besu链A和B
- 已部署的智能合约
- ACA-Py服务（可选）

### 2. 安装和启动

```bash
# 进入webapp目录
cd /home/manifold/cursor/twobesu/webapp

# 运行启动脚本
./start_webapp.sh
```

或者手动安装：

```bash
# 安装依赖
pip3 install -r requirements.txt

# 启动应用
python3 app.py
```

### 3. 访问应用

打开浏览器访问：http://localhost:3000

如果端口3000被占用，应用会自动使用端口3001。

## 📊 功能说明

### 1. 系统状态监控

#### Besu链监控
- **连接状态**: 实时显示链的在线/离线状态
- **链ID**: 显示链的唯一标识符
- **最新区块**: 当前链的最新区块号
- **Gas价格**: 当前网络的Gas价格
- **测试账户余额**: 显示测试账户的ETH余额

#### Oracle服务监控
- **服务状态**: Oracle服务的运行状态
- **服务URL**: Oracle服务的访问地址
- **运行消息**: 服务的状态信息

#### ACA-Py服务监控
- **发行者服务**: ACA-Py发行者代理状态
- **持有者服务**: ACA-Py持有者代理状态
- **管理URL**: 各服务的管理接口地址

#### VC状态监控
- **Schema注册**: 凭证模式是否已注册
- **凭证定义**: 凭证定义是否已创建
- **VC颁发**: 凭证是否已成功颁发

#### 智能合约监控
- **桥接合约**: 跨链桥接合约状态
- **验证合约**: DID验证合约状态
- **代币合约**: 跨链代币合约状态

### 2. 跨链转账操作

#### 转账表单
- **转账金额**: 输入要转账的ETH数量
- **源链**: 选择转账的源区块链
- **目标链**: 选择转账的目标区块链

#### 转账流程
1. 填写转账表单
2. 点击"执行跨链转账"按钮
3. 系统显示转账进度
4. 显示交易哈希和结果

#### 转账结果
- **成功**: 显示交易哈希、金额、时间等信息
- **失败**: 显示错误原因和详细信息

### 3. 实时日志

#### 日志类型
- **INFO**: 一般信息日志
- **SUCCESS**: 成功操作日志
- **WARNING**: 警告信息日志
- **ERROR**: 错误信息日志

#### 日志内容
- 系统状态更新
- 转账操作记录
- 错误和异常信息
- 手动刷新操作

## 🔧 技术架构

### 后端技术
- **Flask**: Web框架
- **Flask-SocketIO**: WebSocket支持
- **FixedWeb3**: 修复的Web3.py连接类
- **aiohttp**: 异步HTTP客户端

### 前端技术
- **HTML5**: 页面结构
- **CSS3**: 样式和布局
- **JavaScript**: 交互逻辑
- **Socket.IO**: 实时通信

### 通信协议
- **HTTP**: RESTful API
- **WebSocket**: 实时状态更新
- **JSON**: 数据交换格式

## 📁 文件结构

```
webapp/
├── app.py                 # 主应用文件
├── requirements.txt       # Python依赖
├── start_webapp.sh       # 启动脚本
├── README.md             # 说明文档
└── templates/
    └── index.html        # 前端页面模板
```

## ⚙️ 配置说明

### 系统配置
在`app.py`中的`SYSTEM_CONFIG`部分可以配置：

```python
SYSTEM_CONFIG = {
    'besu_chain_a': {
        'name': 'Besu Chain A',
        'rpc_url': 'http://localhost:8545',
        'chain_id': 2023,
        'bridge_address': '0x...',
        'verifier_address': '0x...'
    },
    # ... 其他配置
}
```

### 端口配置
- **默认端口**: 3000
- **备用端口**: 3001（如果3000被占用）
- **修改端口**: 编辑`app.py`中的`port=3000`

## 🐛 故障排除

### 常见问题

#### 1. 端口被占用
```bash
# 检查端口占用
lsof -i :3000

# 杀死占用进程
kill -9 <PID>
```

#### 2. Python依赖问题
```bash
# 重新安装依赖
pip3 install -r requirements.txt --force-reinstall
```

#### 3. Web3连接问题
- 确保Besu链正在运行
- 检查RPC URL是否正确
- 查看应用日志中的错误信息

#### 4. 页面无法访问
- 检查防火墙设置
- 确认端口没有被占用
- 查看应用启动日志

### 日志查看
应用运行时会在控制台显示详细日志，包括：
- 系统状态检查结果
- WebSocket连接状态
- 错误和异常信息

## 🔄 更新和维护

### 更新应用
```bash
# 停止应用 (Ctrl+C)
# 更新代码
# 重新启动
./start_webapp.sh
```

### 监控系统
- 定期检查系统状态
- 查看实时日志
- 监控转账操作结果

## 📞 支持

如果遇到问题，请：
1. 查看应用日志
2. 检查系统状态
3. 确认所有依赖服务正在运行
4. 查看本文档的故障排除部分

## 🎉 功能特色

- **实时监控**: 5秒自动刷新系统状态
- **响应式设计**: 支持桌面和移动设备
- **交互式操作**: 直观的转账操作界面
- **详细日志**: 完整的操作记录和错误信息
- **状态指示**: 清晰的服务状态显示
- **自动重连**: WebSocket自动重连机制

这个Web前端为跨链VC系统提供了完整的监控和操作界面，让用户可以直观地了解系统状态并进行跨链操作！
