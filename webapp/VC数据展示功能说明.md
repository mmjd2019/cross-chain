# VC数据展示功能说明

## 功能概述

在webapp中新增了一个专门的页面来展示持有者的VC（可验证凭证）数据和Besu链中智能合约的内部变量数据。

## 新增功能

### 1. VC数据展示
- **VC列表显示**: 展示所有持有的VC，包括类型、发行者、颁发日期、过期日期等信息
- **VC详情查看**: 点击任意VC可查看完整的JSON格式数据
- **实时刷新**: 支持手动刷新VC数据

### 2. 智能合约变量展示
- **双链支持**: 同时显示Besu Chain A和Besu Chain B的合约变量
- **多合约支持**: 显示桥接合约、验证合约、代币合约的内部变量
- **实时数据**: 包括余额、锁定状态、合约状态等关键信息

## 页面结构

### 主要页面
- **主页**: `/` - 原有的系统监控面板
- **VC数据页面**: `/vc-data` - 新增的VC数据和合约变量展示页面

### API端点
- `GET /api/vc-list` - 获取VC列表
- `GET /api/vc-detail/<vc_id>` - 获取特定VC的详细信息
- `GET /api/contract-variables` - 获取智能合约内部变量

## 使用方法

### 启动应用
```bash
# 使用新的启动脚本
./start_vc_data_app.sh

# 或直接运行
python3 enhanced_app.py
```

### 访问页面
1. 打开浏览器访问 `http://localhost:3000`
2. 点击"查看VC数据与合约变量"按钮
3. 或直接访问 `http://localhost:3000/vc-data`

### 功能操作
1. **查看VC列表**: 页面自动加载并显示所有VC
2. **查看VC详情**: 点击任意VC卡片查看完整JSON数据
3. **刷新数据**: 点击"刷新VC列表"或"刷新合约变量"按钮
4. **返回主页**: 点击"返回主页"按钮

## 技术实现

### 后端实现
- 在 `enhanced_app.py` 中添加了新的路由和API端点
- 使用模拟数据展示功能（实际部署时应连接真实的ACA-Py和Web3服务）
- 支持JSON格式的VC数据展示

### 前端实现
- 创建了 `vc_data.html` 模板文件
- 使用响应式设计，支持移动端访问
- 实现了模态框显示VC详情
- 支持实时数据刷新

### 数据格式
- **VC数据**: 符合W3C可验证凭证标准格式
- **合约变量**: 包含代币合约、桥接合约、验证合约的关键变量
- **JSON展示**: 使用语法高亮和格式化显示

## 配置说明

### 系统配置
- 支持两个Besu链的配置
- 可配置合约地址和RPC端点
- 支持ACA-Py服务配置

### 数据源
- **VC数据**: 当前使用模拟数据，实际应连接ACA-Py Holder服务
- **合约变量**: 当前使用模拟数据，实际应通过Web3调用合约方法获取

## 扩展功能

### 未来可扩展的功能
1. **真实数据连接**: 连接真实的ACA-Py和Web3服务
2. **VC验证**: 添加VC验证功能
3. **合约交互**: 支持直接与合约交互
4. **数据导出**: 支持导出VC和合约数据
5. **搜索过滤**: 添加VC搜索和过滤功能

## 注意事项

1. 当前使用模拟数据，生产环境需要连接真实服务
2. 页面支持响应式设计，在移动设备上也能正常使用
3. 所有数据都支持实时刷新
4. VC详情以JSON格式展示，便于开发者查看和调试

## 文件结构

```
webapp/
├── enhanced_app.py              # 主应用文件（已更新）
├── templates/
│   ├── enhanced_index.html      # 主页模板（已更新）
│   └── vc_data.html            # VC数据页面模板（新增）
├── start_vc_data_app.sh        # 启动脚本（新增）
└── VC数据展示功能说明.md        # 功能说明文档（新增）
```
